<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets API Example</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const CLIENT_ID = '43286934508-islgd824fdm1ujdb1vjuf9bu75j7b0oo.apps.googleusercontent.com';
        const API_KEY = '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';
        const SPREADSHEET_ID = '1sMZkez_VE8gB8VT4tcXdc4wd9l9LD2xypNrg1itN6e0';
        const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';
        const SCOPES = 'https://www.googleapis.com/auth/spreadsheets.readonly';

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: [DISCOVERY_DOC],
                scope: SCOPES
            }).then(() => {
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
                document.getElementById('authorize_button').onclick = handleAuthClick;
                document.getElementById('signout_button').onclick = handleSignoutClick;
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                listMajors();
            } else {
                console.log("Not signed in");
            }
        }

        function handleAuthClick(event) {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignoutClick(event) {
            gapi.auth2.getAuthInstance().signOut();
        }

        function listMajors() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: SPREADSHEET_ID,
                range: 'Sheet1!A1:E10',
            }).then((response) => {
                const range = response.result;
                console.log(range);
            }, (response) => {
                console.error('Error: ' + response.result.error.message);
            });
        }
    </script>
</head>
<body onload="handleClientLoad()">
    <button id="authorize_button">Authorize</button>
    <button id="signout_button">Sign Out</button>
</body>
</html>
